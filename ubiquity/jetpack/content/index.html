<html>
<head>
  <title>Extension</title>
</head>
<body>
<!-- Load scripts, etc. for the extension here. -->
<script src="js/init-extension.js"></script>
<script src="js/jquery.js"></script>
<script src="js/observe.js"></script>
<script>
// Just some sample code.
Components.utils.import("resource://jetpack/modules/jetpack_feed_plugin.js");
Components.utils.import("resource://jetpack/modules/init.js");

if (JetpackFeedManager) {
  var watcher = new EventHubWatcher(JetpackFeedManager);
  watcher.add("feed-change", function(name, uri) {
    if (uri.spec in JetpackFeeds)
      console.log("jetpack feed event: " + name + " at", uri.spec);
  });
} else
  console.log("JetpackFeedManager is null");

function tick() {
  var urls = [];
  for (url in JetpackFeeds)
    urls.push(url);
  var numWeakRefs = getExtensionDebugInfo().weakRefs.length;
  $(document.body).text(urls.join(", ") + " " + numWeakRefs);
}

$(window).ready(function() {
  window.setInterval(tick, 1000);
});
</script>
</body>
</html>
