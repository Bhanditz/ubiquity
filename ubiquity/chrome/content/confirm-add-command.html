<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html> <head>
<title></title>
<script>

function getUrlParams() {
  var urlFragments = document.URL.split("?")[1];
  urlFragments = urlFragments.split("&");
  var params = {};
  for( var x in urlFragments ) {
    var fragFrags = urlFragments[x].split("=");
    params[ fragFrags[0] ] = fragFrags[1];
  }
  return params;
}

var gCommandFeedInfo = getUrlParams();

function bookmarkCommand(sourceUrl) {
  var Cc = Components.classes;
  var Ci = Components.interfaces;
  var annSvc = Cc["@mozilla.org/browser/annotation-service;1"]
               .getService(Ci.nsIAnnotationService);
  var ioSvc = Cc["@mozilla.org/network/io-service;1"]
               .getService(Ci.nsIIOService);
  var uri = ioSvc.newURI(sourceUrl, null, null);
  annSvc.setPageAnnotation(uri, "ubiquity/confirmed", "true", 0,
                           annSvc.EXPIRE_NEVER);
}
</script>
</head>

<body bgcolor="#ff0000">
<h1 style="color:#ffff00; text-align:center; font-size:72pt">
<blink>BEWARE, HUMAN!</blink></h1>

<p>You are about to subscribe to a <a href="about:ubiquity">Ubiquity</a>
command from an unknown, untrusted third-party source

<script>
document.write( "at <a href=\"" + gCommandFeedInfo.url + "\">" +
                gCommandFeedInfo.url + "</a>");
</script>
. If you subscribe, this command could do <i>anything it wants</i> to your browser.
It could steal your credit card number or e-mail your grandmother your entire image
browsing history.</p>

<p>Here is the JavaScript source code to the command:</p>

<script>
document.write( "<iframe width=\"80%\" src=\"" +
                 gCommandFeedInfo.sourceUrl +
                 "\"></iframe>");
</script>

<p>If you understand JavaScript, you should read

<script>
document.write( "<a href=\"" + gCommandFeedInfo.sourceUrl + "\">" +
                "the source code</a>");
</script>
and try to understand what the command will do in order to decide whether it's safe
to install or not. If you don't understand JavaScript, you should not subscribe to the command
unless this link was given to you by someone you know and trust.</p>

<div class="todo" style="border-style:solid; border-width:2px; width:80%; padding:10px; border-color:#ffff00"><p><i>In the future, we plan to have a widget here
  displaying what we call a &quot;social trust network&quot;.  You'll be able
  to see whether any of your friends have tried out this command.  They can
  either vouch for the command's safety or leave a warning about the command's
  dangers.  We hope this will help people make informed decisions about whether
  to subscribe to commands or not.  This feature should be coming in Ubiquity 0.2.
  </i></p></div>

<p>You can use the Ubiquity &quot;help&quot; command at any time to get to the
<a href="about:ubiquity">command management page</a>, where you can see what
commands you are subscribed to, and cancel any that you no longer want.</p>

<p><input type="submit" value="Get me outta here!" onclick=""/>
&nbsp;&nbsp;&nbsp;&nbsp;
<input type="submit" value="I know what I'm doing. Subscribe to it!"
  onclick="bookmarkCommand(gCommandFeedInfo.sourceUrl);"/>
</p>

</body> </html>
